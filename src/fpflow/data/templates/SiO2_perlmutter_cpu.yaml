#region: basic info 
structures:
  active_idx: 0
  list:
    - name: 'SiO2'
      file:
        type: 'localfile'        # localfile, mpapi-id, mpapi-formula. Set MP_API in environment if using mp. 
        value: '/pscratch/sd/k/krishnaa/Simulations/SiO2/conv/atoms.xsf' 
      cell:
        unit: angstrom  # angstrom, bohr, alat. 
        read_if_relaxed: true
        # Specify either 'vectors' or 'bravais_lattice_info'
        vectors:
            # - [-0.000000000,   5.102704622,   5.102704622]
            # - [ 5.102704622,  -0.000000000,   5.102704622]
            # - [ 5.102704622,   5.102704622,  -0.000000000]
        bravais_lattice_info:
          # ibrav: 'fcc'
          # A: 4.03  # in angstrom if cell.unit is angstrom
      positions:
        unit: crystal   # angstrom, bohr, crystal, alat. 
        read_if_relaxed: true
        coords:
          # - ['Li', 0.00, 0.00, 0.00]
          # - ['F', 0.50, 0.50, 0.50]
        # vca:    # Virtual crystal approximation. 
        #   - ['Si', 'Ag', 0.2]
      # supercell_size: [2, 2, 2]

kpath:
  special_points:
    - G
    - X
    - W
    - K
    - G
    - L
    - U
    - W
    - L
    - K
  npoints_segment: 10  

common:
  qshift: &qshift [0.000, 0.000, 0.001]
  
  coarse_sym: &coarse_sym true
  coarse_kgrid: &coarse_kgrid [4, 4, 4]
  coarse_nk: &coarse_nk 64

  fine_sym: &fine_sym true
  fine_kgrid: &fine_kgrid [4, 4, 4]
  fine_nk: &fine_nk 64
  
  qgrid: &qgrid [4, 4, 4]
  dfpt_ni_nodes_auto_assign: &dfpt_ni_nodes_auto_assign true 
  epw_nodes: &epw_nodes 1
  epw_nk: &epw_nk 64
  
  dft:
    ecut: &dft_ecut 80.0
    kgrid: &scf_kgrid [4, 4, 4]
    val_bands: &dft_valbands 5
    cond_bands: &dft_condbands 7
    xc: &dft_xc 'pbe'  # pbe, lda. 
    is_spinorbit: &dft_spinorbit true
  gw:
    ecut: &gwecut 30.0
    val_bands: &gw_valbands 5
    cond_bands: &gw_condbands 7
    para_cond_bands: &gw_para_condbands 10001
    is_pseudobands: &is_pseudobands true
    conv_cond_bands: &gw_conv_condbands 10000
  gwelbands:
    val_bands: &gwelbands_valbands 4
    cond_bands: &gwelbands_condbands 5
  bse:
    val_bands: &bse_valbands 5
    cond_bands: &bse_condbands 7
    nxct: &bse_nxct 10
    supercell_size: &xct_supercell_size [4, 4, 4]
    hole_position: &xct_hole_position [0.00, 0.00, 0.00]
    elec_position: &xct_elec_position [0.5, 0.5, 0.5]
    xct_state: &xct_state 1
    spinor: &plotxct_spinor # Only activated in spin orbit coupling mode. 1 is up, 2 is down.
      electron_spin: 2      
      hole_spin: 1
  job_types:
    scheduler: &scheduler_dict
      name: &scheduler_name 'perlmutter_cpu'
      is_interactive: true
    interactive:
      nodes: &interactive_nodes 1
      time: &interactive_time 03:40:00
    single:
      nodes: &single_nodes 1
      ntasks: &single_ntasks 128
      time: &single_time "02:45:00"
    para:
      nodes: &para_nodes 4
      ntasks: &para_ntasks 512
      time: &para_time "02:45:00"
    big:
      nodes: &big_nodes 4
      ntasks: &big_ntasks 512
      time: &big_time "02:45:00"

generator:
  dest_dir: ./
  pre_steps:
    - pseudos_qe
  steps: &gen_steps
  # #  - esr_gen
   - relax_qe
  # #  - cdft_qe
  # #  - md_qe
  # #  - ml_deepmd
   - scf_qe
  # #  - scf_pw2bgw_qe
  # #  - scf_abacus
  # #  - scf_siesta
  # #  - ml_dftqe
  # #  - ml_dfptqe
  # #  - ml_dvscqe
  # #  - ml_dnvscqe
  # #  - ml_dftabacus
  # #  - ml_dftsiesta
  #  - dfpt_qe
  # #  - pp_dvsc_dfpt
  # #  - elph_dfpt
  #  - phbands_qe
  # #  - phdos_qe
  #  - phmodes_qe
  # #  - dos_qe
  # #  - pdos_qe 
  #  - dftelbands_qe
  # #  - kpdos_qe
  # #  - wannier_qe
  # #  - tbmodels
  #  - wfn_qe
  # #  - pp_wfnqe
  # #  - pp_wfnqesym
  # #  - wfn_abacus
  # #  - wfn_siesta
  # #  - epw_qe
  # #  - elph_epw
  #  - wfnq_qe
  # #  - wfnq_abacus
  # #  - wfnq_siesta
  # #  - wfnfi_qe
  # #  - wfnqfi_qe
  #  - phonopy_qe
  # #  - pp_dvscf_phonopy
  # #  - elph_phonopy
  #  - epsilon_bgw
  # #  - sigmasc_bgw
  # #  - epsilonsc_bgw
  #  - sigma_bgw
  # #  - ml_gwqe
  #  - gwelbands_bgw
  #  - kernel_bgw
  #  - absorption_bgw
  #  - plotxct_bgw
  # #  - bseq_bgw
  # #  - ml_bseqe
  # #  - xctwannier_bgw
  # #  - xctph
  # #  - xctpol
  # #  - ste
  # #  - esf
  # #  - esr
  #  - convergence_scf_qe
  #  - convergence_dfpt_qe
  #  - convergence_gw_qe
   - convergence_bse_qe
  post_steps:
    - create_script
    - run_script
    - remove_script
    - plot_script
    - interactive_script

manager:
  dest_dir: ./
  steps:
    - convergence_bse_qe
  plots:
    - convergence_bse_qe

#endregion: basic info

job_types:
  interactive:
    name: *scheduler_name
    is_interactive: true
    nodes: *interactive_nodes
    time: *interactive_time
  single_task: &single_task
    <<: *scheduler_dict
    nodes: 1
    ntasks: 1
    time: *single_time
  single_node: &single_node
    <<: *scheduler_dict
    nodes: 1
    ntasks: *single_ntasks
    time: *single_time
  para: &para
    <<: *scheduler_dict
    nodes: *para_nodes
    ntasks: *para_ntasks
    time: *para_time
  para_k: &para_k
    <<: *scheduler_dict
    nodes: *para_nodes
    ntasks: *para_ntasks
    time: *para_time
  big_para: &big_para
    <<: *scheduler_dict
    nodes: *big_nodes
    ntasks: *big_ntasks
    time: *big_time
  big_para_k: &big_para_k
    <<: *scheduler_dict
    nodes: *big_nodes
    ntasks: *big_ntasks
    time: *big_time
  para_epwk: &para_epwk
    <<: *scheduler_dict
    nodes: *epw_nodes
    ntasks: *epw_nk
    nk: *epw_nk
    time: *big_time

relax:
  type: 'vc-relax'  # Options are: relax, vcrelax, cdft-relax, cdft-vcrelax.  
  update_coord: true
  args:
    control:
      forc_conv_thr: '1.0d-6'
  job_info:
    <<: *para
cdft:
  type: 'vc-relax'
  update_coord: false
  excited_cond_band: 1 # relative to the fermi level. 1 start index
  removed_val_band: -1  # relative to the fermi level. 1 start index 
  args:
  job_info:
    <<: *para
md:
  kgrid: *coarse_kgrid
  type: 'md'      # Can be md or vc-md. 
  time_step: 20   # 20 a.u. a.u = 48 as. 
  nsteps: 100
  temp: 300
  structure_index: 0    # Choose which structure index to start with for md. 0 index based.
  args:
  job_info:
    <<: *para
scf:
  kgrid: *scf_kgrid
  ecut: *dft_ecut
  is_spinorbit: *dft_spinorbit
  xc: *dft_xc
  args:
    electrons:
      conv_thr: '1.0d-8'
  job_info:
    <<: *para
scf_pw2bgw:
  args:
  job_info:
    <<: *para
dfpt:
  qgrid: *qgrid
  auto_assign_ni_and_nodes: *dfpt_ni_nodes_auto_assign
  conv_thr: '1.0d-16'
  args:
  job_info:
    <<: *big_para
phbands:
  q2r_args:
  matdyn_args:
  job_info:
    <<: *single_node
phdos:
  qgrid: *qgrid
  q2r_args:
  matdyn_args:
  job_info:
    <<: *single_node
phmodes:
  qpt_idx: 1
  args:
  job_info:
    <<: *single_node
dos:
  kgrid: *coarse_kgrid
  cond_bands: *dft_condbands
  wfn_args:
  args:
  job_info:
    <<: *para
pdos:
  args:
  job_info:
    <<: *para
dftelbands:
  val_bands: *dft_valbands
  cond_bands: *dft_condbands
  pw2bgw_args:
  job_pw2bgw_info:
    <<: *para
  args:
  job_info:
    <<: *para
kpdos:
  args:
  job_info:
    <<: *para
wannier:
  kgrid: *coarse_kgrid
  val_bands: *dft_valbands
  cond_bands: *dft_condbands
  args:
  job_info:
    <<: *single_node
phonopy:
  job_info:
    <<: *big_para
wfn:
  kgrid: *coarse_kgrid
  sym: *coarse_sym
  cond_bands: *gw_condbands
  parabands_cond_bands: *gw_para_condbands
  is_pseudobands: *is_pseudobands
  pw2bgw_args:
  parabands_args:
  args:
  job_pw2bgw_info:
   name: 'perlmutter_cpu'
   is_interactive: true
   nodes: 1
   ntasks: 64
   time: "02:45:00"
  job_parabands_info:
    <<: *big_para
  job_info:
   name: 'perlmutter_cpu'
   is_interactive: true
   nodes: 1
   ntasks: 64
   time: "02:45:00"
epw:
  args:
  job_info:
    <<: *para_epwk
elph:
  job_info:
    <<: *big_para
wfnq:
  qshift: *qshift
  kgrid: *coarse_kgrid
  sym: *coarse_sym
  cond_bands: *gw_condbands
  pw2bgw_args:
  args:
  job_pw2bgw_info:
    name: 'perlmutter_cpu'
    is_interactive: true
    nodes: 1
    ntasks: 64
    time: "02:45:00"
  job_info:
    name: 'perlmutter_cpu'
    is_interactive: true
    nodes: 1
    ntasks: 64
    time: "02:45:00"
wfnfi:
  kgrid: *fine_kgrid
  sym: *fine_sym
  cond_bands: *gw_condbands
  pw2bgw_args:
  args:
  job_pw2bgw_info:
    name: 'perlmutter_cpu'
    is_interactive: true
    nodes: 1
    ntasks: 64
    time: "02:45:00"
  job_info:
    name: 'perlmutter_cpu'
    is_interactive: true
    nodes: 1
    ntasks: 64
    time: "02:45:00"
wfnqfi:
  kgrid: *fine_kgrid
  sym: *fine_sym
  cond_bands: *gw_condbands
  pw2bgw_args:
  args:
  job_pw2bgw_info:
    name: 'perlmutter_cpu'
    is_interactive: true
    nodes: 1
    ntasks: 64
    time: "02:45:00"
  job_info:
    name: 'perlmutter_cpu'
    is_interactive: true
    nodes: 1
    ntasks: 64
    time: "02:45:00"
gw:
  epsilon:
    ecut: *gwecut
    cond_bands: *gw_conv_condbands
    wfnlink: 'WFN_parabands.h5'
    wfnqlink: 'WFNq_coo.h5'
    args:
    job_info:
      <<: *para
  sigma:
    ecut: *gwecut
    conv_cond_bands: *gw_conv_condbands
    cond_bands: *gw_condbands
    val_bands: *gw_valbands
    wfnlink: 'WFN_parabands.h5' 
    args:
    job_info:
      <<: *big_para
  gwelbands:
    val_bands: *gwelbands_valbands
    cond_bands: *gwelbands_condbands
    wfnco_link: 'WFN_coo'
    wfnfi_link: 'WFN_dftelbands'
    args:
    job_info:
      <<: *para
bse:
  kernel:
    qshift: [0.0, 0.0, 0.0]
    args:
    job_info:
      <<: *big_para
  absorption:
    qshift: [0.0, 0.0, 0.0]
    val_bands: *bse_valbands
    cond_bands: *bse_condbands
    nxct: *bse_nxct
    pol_dir: *qshift
    wfnco_link: 'WFN_parabands.h5'
    wfnqco_link: 'WFNq_coo.h5'
    wfnfi_link: 'WFN_fii.h5'
    wfnqfi_link: 'WFNq_fii.h5'
    args:
    job_info:
      <<: *para
  plotxct:
    hole_position: *xct_hole_position
    supercell_size: *xct_supercell_size
    elec_position: *xct_elec_position
    xct_state: *xct_state
    spinor: *plotxct_spinor
    args:
    job_info:
      <<: *big_para
bseq:
  sym: *coarse_sym
  qgrid: *coarse_kgrid
  job_info:
    <<: *big_para
xctph:
  nxct: *bse_nxct
  job_info:
    <<: *big_para
xctpol:
  temp: 300
  nxct: *bse_nxct
  max_error: 1e-1
  max_steps: 10
  job_info:
    <<: *big_para
ste:
  temp: 300
  nxct: *bse_nxct
  max_error: 1e-1
  max_steps: 10
  job_info:
    <<: *big_para
esf:
  job_info:
    <<: *big_para
esr:
  supercell_size: [2, 2, 2]
  max_error: 1e-3
  max_steps: 3
  job_info:
    <<: *big_para
mldftqe:
  job_info:
    <<: *big_para
convergence:
  qescf:
    dir_list:
      # dset_00
      - dirname: dset_00
        params:
          - path: 'scf.ecut'
            value: 40.0
          - path: 'scf.kgrid'
            value: [2, 2, 2]
        link_inodes:
        generator:
          pre_steps: ['pseudos_qe']
          steps: ['scf_qe', 'dftelbands_qe']
          post_steps: ['create_script', 'run_script', 'remove_script', 'plot_script', 'interactive_script']
      # dset_01
      - dirname: dset_01
        params:
          - path: 'scf.ecut'
            value: 60.0
          - path: 'scf.kgrid'
            value: [2, 2, 2]
        link_inodes:
        generator:
          pre_steps: ['pseudos_qe']
          steps: ['scf_qe', 'dftelbands_qe']
          post_steps: ['create_script', 'run_script', 'remove_script', 'plot_script', 'interactive_script']
      # dset_02
      - dirname: dset_02
        params:
          - path: 'scf.ecut'
            value: 80.0
          - path: 'scf.kgrid'
            value: [2, 2, 2]
        link_inodes:
        generator:
          pre_steps: ['pseudos_qe']
          steps: ['scf_qe', 'dftelbands_qe']
          post_steps: ['create_script', 'run_script', 'remove_script', 'plot_script', 'interactive_script']
      # dset_03
      - dirname: dset_03
        params:
          - path: 'scf.ecut'
            value: 100.0
          - path: 'scf.kgrid'
            value: [2, 2, 2]
        link_inodes:
        generator:
          pre_steps: ['pseudos_qe']
          steps: ['scf_qe', 'dftelbands_qe']
          post_steps: ['create_script', 'run_script', 'remove_script', 'plot_script', 'interactive_script']
      # dset_04
      - dirname: dset_04
        params:
          - path: 'scf.ecut'
            value: 120.0
          - path: 'scf.kgrid'
            value: [2, 2, 2]
        link_inodes:
        generator:
          pre_steps: ['pseudos_qe']
          steps: ['scf_qe', 'dftelbands_qe']
          post_steps: ['create_script', 'run_script', 'remove_script', 'plot_script', 'interactive_script']
      # dset_05
      - dirname: dset_05
        params:
          - path: 'scf.ecut'
            value: 140.0
          - path: 'scf.kgrid'
            value: [2, 2, 2]
        link_inodes:
        generator:
          pre_steps: ['pseudos_qe']
          steps: ['scf_qe', 'dftelbands_qe']
          post_steps: ['create_script', 'run_script', 'remove_script', 'plot_script', 'interactive_script']
      # dset_06
      - dirname: dset_06
        params:
          - path: 'scf.ecut'
            value: 60.0
          - path: 'scf.kgrid'
            value: [4, 4, 4]
        link_inodes:
        generator:
          pre_steps: ['pseudos_qe']
          steps: ['scf_qe', 'dftelbands_qe']
          post_steps: ['create_script', 'run_script', 'remove_script', 'plot_script', 'interactive_script']
      # dset_07
      - dirname: dset_07
        params:
          - path: 'scf.ecut'
            value: 60.0
          - path: 'scf.kgrid'
            value: [6, 6, 6]
        link_inodes:
        generator:
          pre_steps: ['pseudos_qe']
          steps: ['scf_qe', 'dftelbands_qe']
          post_steps: ['create_script', 'run_script', 'remove_script', 'plot_script', 'interactive_script']
      # dset_08
      - dirname: dset_08
        params:
          - path: 'scf.ecut'
            value: 60.0
          - path: 'scf.kgrid'
            value: [8, 8, 8]
        link_inodes:
        generator:
          pre_steps: ['pseudos_qe']
          steps: ['scf_qe', 'dftelbands_qe']
          post_steps: ['create_script', 'run_script', 'remove_script', 'plot_script', 'interactive_script']
    job_info:
      <<: *big_para
    plot:
      # dirs: [dset_00, dset_01, dset_02, dset_03, dset_04, dset_05] # ecut convergence.
      dirs: [dset_01, dset_06, dset_07, dset_08] # kgrid convergence.
  qedfpt:
    dir_list:
      # dset_00
      - dirname: 'dset_00'
        params:
          - path: 'relax.args.control.forc_conv_thr'
            value: '1.0d-6'
          - path: 'scf.ecut'
            value: 40.0
          - path: 'scf.args.electrons.conv_thr'
            value: '1.0d-8'
          - path: 'scf.kgrid'
            value: [2, 2, 2]
          - path: 'dfpt.conv_thr'
            value: '1.0d-14'
          - path: 'dfpt.qgrid'
            value: [2, 2, 2]
        link_inodes:
        generator:
          pre_steps: ['pseudos_qe']
          steps: ['scf_qe', 'dfpt_qe', 'phbands_qe']
          post_steps: ['create_script', 'run_script', 'remove_script', 'plot_script', 'interactive_script']
      # dset_01
      - dirname: 'dset_01'
        params:
          - path: 'relax.args.control.forc_conv_thr'
            value: '1.0d-6'
          - path: 'scf.ecut'
            value: 60.0
          - path: 'scf.args.electrons.conv_thr'
            value: '1.0d-8'
          - path: 'scf.kgrid'
            value: [2, 2, 2]
          - path: 'dfpt.conv_thr'
            value: '1.0d-14'
          - path: 'dfpt.qgrid'
            value: [2, 2, 2]
        link_inodes:
        generator:
          pre_steps: ['pseudos_qe']
          steps: ['scf_qe', 'dfpt_qe', 'phbands_qe']
          post_steps: ['create_script', 'run_script', 'remove_script', 'plot_script', 'interactive_script']
      # dset_02
      - dirname: 'dset_02'
        params:
          - path: 'relax.args.control.forc_conv_thr'
            value: '1.0d-6'
          - path: 'scf.ecut'
            value: 80.0
          - path: 'scf.args.electrons.conv_thr'
            value: '1.0d-8'
          - path: 'scf.kgrid'
            value: [2, 2, 2]
          - path: 'dfpt.conv_thr'
            value: '1.0d-14'
          - path: 'dfpt.qgrid'
            value: [2, 2, 2]
        link_inodes:
        generator:
          pre_steps: ['pseudos_qe']
          steps: ['scf_qe', 'dfpt_qe', 'phbands_qe']
          post_steps: ['create_script', 'run_script', 'remove_script', 'plot_script', 'interactive_script']
      # dset_03
      - dirname: 'dset_03'
        params:
          - path: 'relax.args.control.forc_conv_thr'
            value: '1.0d-6'
          - path: 'scf.ecut'
            value: 100.0
          - path: 'scf.args.electrons.conv_thr'
            value: '1.0d-8'
          - path: 'scf.kgrid'
            value: [2, 2, 2]
          - path: 'dfpt.conv_thr'
            value: '1.0d-14'
          - path: 'dfpt.qgrid'
            value: [2, 2, 2]
        link_inodes:
        generator:
          pre_steps: ['pseudos_qe']
          steps: ['scf_qe', 'dfpt_qe', 'phbands_qe']
          post_steps: ['create_script', 'run_script', 'remove_script', 'plot_script', 'interactive_script']
      # dset_04
      - dirname: 'dset_04'
        params:
          - path: 'relax.args.control.forc_conv_thr'
            value: '1.0d-6'
          - path: 'scf.ecut'
            value: 80.0
          - path: 'scf.args.electrons.conv_thr'
            value: '1.0d-8'
          - path: 'scf.kgrid'
            value: [4, 4, 4]
          - path: 'dfpt.conv_thr'
            value: '1.0d-14'
          - path: 'dfpt.qgrid'
            value: [4, 4, 4]
        link_inodes:
        generator:
          pre_steps: ['pseudos_qe']
          steps: ['scf_qe', 'dfpt_qe', 'phbands_qe']
          post_steps: ['create_script', 'run_script', 'remove_script', 'plot_script', 'interactive_script'] 
      # dset_05
      - dirname: 'dset_05'
        params:
          - path: 'relax.args.control.forc_conv_thr'
            value: '1.0d-6'
          - path: 'scf.ecut'
            value: 80.0
          - path: 'scf.args.electrons.conv_thr'
            value: '1.0d-8'
          - path: 'scf.kgrid'
            value: [6, 6, 6]
          - path: 'dfpt.conv_thr'
            value: '1.0d-14'
          - path: 'dfpt.qgrid'
            value: [6, 6, 6]
        link_inodes:
        generator:
          pre_steps: ['pseudos_qe']
          steps: ['scf_qe', 'dfpt_qe', 'phbands_qe']
          post_steps: ['create_script', 'run_script', 'remove_script', 'plot_script', 'interactive_script'] 
    job_info:
      <<: *big_para
    plot:
      # dirs: [dset_00, dset_01, dset_02, dset_03] # ecut convergence. 
      dirs: [dset_02, dset_04, dset_05] # kgrid convergence. 
      # dirs: [dset_02, dset_03]
      # dirs: [dset_03]
  bgwgw:
    dir_list:
      # dset_00
      - dirname: dset_00
        params:
          - path: 'scf.ecut'
            value: 80.0
          - path: 'scf.kgrid'
            value: [2, 2, 2]
          - path: 'wfn.kgrid'
            value: [2, 2, 2]
          - path: 'wfn.parabands_cond_bands'
            value: 2501
          - path: 'wfnq.kgrid'
            value: [2, 2, 2]
          - path: 'gw.epsilon.ecut'
            value: 5.0
          - path: 'gw.epsilon.cond_bands'
            value: 2500
          - path: 'gw.sigma.ecut'
            value: 5.0
          - path: 'gw.sigma.conv_cond_bands'
            value: 2500
        link_inodes:
          - source: ../../qescf/dset_02/tmp
            dest: ./tmp
          - source: ../../qescf/dset_02/pseudos
            dest: ./pseudos
        generator:
          pre_steps: []
          steps: ['dftelbands_qe', 'wfn_qe', 'wfnq_qe', 'epsilon_bgw', 'sigma_bgw', 'gwelbands_bgw']
          post_steps: ['create_script', 'run_script', 'remove_script', 'plot_script', 'interactive_script']
      # dset_01
      - dirname: dset_01
        params:
          - path: 'scf.ecut'
            value: 80.0
          - path: 'scf.kgrid'
            value: [2, 2, 2]
          - path: 'wfn.kgrid'
            value: [2, 2, 2]
          - path: 'wfn.parabands_cond_bands'
            value: 2501
          - path: 'wfnq.kgrid'
            value: [2, 2, 2]
          - path: 'gw.epsilon.ecut'
            value: 10.0
          - path: 'gw.epsilon.cond_bands'
            value: 2500
          - path: 'gw.sigma.ecut'
            value: 10.0
          - path: 'gw.sigma.conv_cond_bands'
            value: 2500
        link_inodes:
          - source: ../../bgwgw/dset_00/tmp
            dest: ./tmp
          - source: ../../bgwgw/dset_00/pseudos
            dest: ./pseudos
          - source: ../../bgwgw/dset_00/dftelbands.xml
            dest: ./dftelbands.xml
          - source: ../../bgwgw/dset_00/WFN_dftelbands
            dest: ./WFN_dftelbands
          - source: ../../bgwgw/dset_00/WFN_coo
            dest: ./WFN_coo
          - source: ../../bgwgw/dset_00/WFN_parabands.h5
            dest: ./WFN_parabands.h5
          - source: ../../bgwgw/dset_00/RHO
            dest: ./RHO
          - source: ../../bgwgw/dset_00/vxc.dat
            dest: ./vxc.dat
          - source: ../../bgwgw/dset_00/WFNq_coo.h5
            dest: ./WFNq_coo.h5
        generator:
          pre_steps: []
          steps: ['epsilon_bgw', 'sigma_bgw', 'gwelbands_bgw']
          post_steps: ['create_script', 'run_script', 'remove_script', 'plot_script', 'interactive_script']
      # dset_02
      - dirname: dset_02
        params:
          - path: 'scf.ecut'
            value: 80.0
          - path: 'scf.kgrid'
            value: [2, 2, 2]
          - path: 'wfn.kgrid'
            value: [2, 2, 2]
          - path: 'wfn.parabands_cond_bands'
            value: 2501
          - path: 'wfnq.kgrid'
            value: [2, 2, 2]
          - path: 'gw.epsilon.ecut'
            value: 15.0
          - path: 'gw.epsilon.cond_bands'
            value: 2500
          - path: 'gw.sigma.ecut'
            value: 15.0
          - path: 'gw.sigma.conv_cond_bands'
            value: 2500
        link_inodes:
          - source: ../../bgwgw/dset_00/tmp
            dest: ./tmp
          - source: ../../bgwgw/dset_00/pseudos
            dest: ./pseudos
          - source: ../../bgwgw/dset_00/dftelbands.xml
            dest: ./dftelbands.xml
          - source: ../../bgwgw/dset_00/WFN_dftelbands
            dest: ./WFN_dftelbands
          - source: ../../bgwgw/dset_00/WFN_coo
            dest: ./WFN_coo
          - source: ../../bgwgw/dset_00/WFN_parabands.h5
            dest: ./WFN_parabands.h5
          - source: ../../bgwgw/dset_00/RHO
            dest: ./RHO
          - source: ../../bgwgw/dset_00/vxc.dat
            dest: ./vxc.dat
          - source: ../../bgwgw/dset_00/WFNq_coo.h5
            dest: ./WFNq_coo.h5
        generator:
          pre_steps: []
          steps: ['epsilon_bgw', 'sigma_bgw', 'gwelbands_bgw']
          post_steps: ['create_script', 'run_script', 'remove_script', 'plot_script', 'interactive_script']
      # dset_03
      - dirname: dset_03
        params:
          - path: 'scf.ecut'
            value: 80.0
          - path: 'scf.kgrid'
            value: [2, 2, 2]
          - path: 'wfn.kgrid'
            value: [2, 2, 2]
          - path: 'wfn.parabands_cond_bands'
            value: 2501
          - path: 'wfnq.kgrid'
            value: [2, 2, 2]
          - path: 'gw.epsilon.ecut'
            value: 20.0
          - path: 'gw.epsilon.cond_bands'
            value: 2500
          - path: 'gw.sigma.ecut'
            value: 20.0
          - path: 'gw.sigma.conv_cond_bands'
            value: 2500
        link_inodes:
          - source: ../../bgwgw/dset_00/tmp
            dest: ./tmp
          - source: ../../bgwgw/dset_00/pseudos
            dest: ./pseudos
          - source: ../../bgwgw/dset_00/dftelbands.xml
            dest: ./dftelbands.xml
          - source: ../../bgwgw/dset_00/WFN_dftelbands
            dest: ./WFN_dftelbands
          - source: ../../bgwgw/dset_00/WFN_coo
            dest: ./WFN_coo
          - source: ../../bgwgw/dset_00/WFN_parabands.h5
            dest: ./WFN_parabands.h5
          - source: ../../bgwgw/dset_00/RHO
            dest: ./RHO
          - source: ../../bgwgw/dset_00/vxc.dat
            dest: ./vxc.dat
          - source: ../../bgwgw/dset_00/WFNq_coo.h5
            dest: ./WFNq_coo.h5
        generator:
          pre_steps: []
          steps: ['epsilon_bgw', 'sigma_bgw', 'gwelbands_bgw']
          post_steps: ['create_script', 'run_script', 'remove_script', 'plot_script', 'interactive_script']
      # dset_04
      - dirname: dset_04
        params:
          - path: 'scf.ecut'
            value: 80.0
          - path: 'scf.kgrid'
            value: [2, 2, 2]
          - path: 'wfn.kgrid'
            value: [2, 2, 2]
          - path: 'wfn.parabands_cond_bands'
            value: 2501
          - path: 'wfnq.kgrid'
            value: [2, 2, 2]
          - path: 'gw.epsilon.ecut'
            value: 25.0
          - path: 'gw.epsilon.cond_bands'
            value: 2500
          - path: 'gw.sigma.ecut'
            value: 25.0
          - path: 'gw.sigma.conv_cond_bands'
            value: 2500
        link_inodes:
          - source: ../../bgwgw/dset_00/tmp
            dest: ./tmp
          - source: ../../bgwgw/dset_00/pseudos
            dest: ./pseudos
          - source: ../../bgwgw/dset_00/dftelbands.xml
            dest: ./dftelbands.xml
          - source: ../../bgwgw/dset_00/WFN_dftelbands
            dest: ./WFN_dftelbands
          - source: ../../bgwgw/dset_00/WFN_coo
            dest: ./WFN_coo
          - source: ../../bgwgw/dset_00/WFN_parabands.h5
            dest: ./WFN_parabands.h5
          - source: ../../bgwgw/dset_00/RHO
            dest: ./RHO
          - source: ../../bgwgw/dset_00/vxc.dat
            dest: ./vxc.dat
          - source: ../../bgwgw/dset_00/WFNq_coo.h5
            dest: ./WFNq_coo.h5
        generator:
          pre_steps: []
          steps: ['epsilon_bgw', 'sigma_bgw', 'gwelbands_bgw']
          post_steps: ['create_script', 'run_script', 'remove_script', 'plot_script', 'interactive_script']
      # dset_05
      - dirname: dset_05
        params:
          - path: 'scf.ecut'
            value: 80.0
          - path: 'scf.kgrid'
            value: [2, 2, 2]
          - path: 'wfn.kgrid'
            value: [2, 2, 2]
          - path: 'wfn.parabands_cond_bands'
            value: 2501
          - path: 'wfnq.kgrid'
            value: [2, 2, 2]
          - path: 'gw.epsilon.ecut'
            value: 30.0
          - path: 'gw.epsilon.cond_bands'
            value: 2500
          - path: 'gw.sigma.ecut'
            value: 30.0
          - path: 'gw.sigma.conv_cond_bands'
            value: 2500
        link_inodes:
          - source: ../../bgwgw/dset_00/tmp
            dest: ./tmp
          - source: ../../bgwgw/dset_00/pseudos
            dest: ./pseudos
          - source: ../../bgwgw/dset_00/dftelbands.xml
            dest: ./dftelbands.xml
          - source: ../../bgwgw/dset_00/WFN_dftelbands
            dest: ./WFN_dftelbands
          - source: ../../bgwgw/dset_00/WFN_coo
            dest: ./WFN_coo
          - source: ../../bgwgw/dset_00/WFN_parabands.h5
            dest: ./WFN_parabands.h5
          - source: ../../bgwgw/dset_00/RHO
            dest: ./RHO
          - source: ../../bgwgw/dset_00/vxc.dat
            dest: ./vxc.dat
          - source: ../../bgwgw/dset_00/WFNq_coo.h5
            dest: ./WFNq_coo.h5
        generator:
          pre_steps: []
          steps: ['epsilon_bgw', 'sigma_bgw', 'gwelbands_bgw']
          post_steps: ['create_script', 'run_script', 'remove_script', 'plot_script', 'interactive_script']
      # dset_06
      - dirname: dset_06
        params:
          - path: 'scf.ecut'
            value: 80.0
          - path: 'scf.kgrid'
            value: [2, 2, 2]
          - path: 'wfn.kgrid'
            value: [2, 2, 2]
          - path: 'wfn.parabands_cond_bands'
            value: 2501
          - path: 'wfnq.kgrid'
            value: [2, 2, 2]
          - path: 'gw.epsilon.ecut'
            value: 35.0
          - path: 'gw.epsilon.cond_bands'
            value: 2500
          - path: 'gw.sigma.ecut'
            value: 35.0
          - path: 'gw.sigma.conv_cond_bands'
            value: 2500
        link_inodes:
          - source: ../../bgwgw/dset_00/tmp
            dest: ./tmp
          - source: ../../bgwgw/dset_00/pseudos
            dest: ./pseudos
          - source: ../../bgwgw/dset_00/dftelbands.xml
            dest: ./dftelbands.xml
          - source: ../../bgwgw/dset_00/WFN_dftelbands
            dest: ./WFN_dftelbands
          - source: ../../bgwgw/dset_00/WFN_coo
            dest: ./WFN_coo
          - source: ../../bgwgw/dset_00/WFN_parabands.h5
            dest: ./WFN_parabands.h5
          - source: ../../bgwgw/dset_00/RHO
            dest: ./RHO
          - source: ../../bgwgw/dset_00/vxc.dat
            dest: ./vxc.dat
          - source: ../../bgwgw/dset_00/WFNq_coo.h5
            dest: ./WFNq_coo.h5
        generator:
          pre_steps: []
          steps: ['epsilon_bgw', 'sigma_bgw', 'gwelbands_bgw']
          post_steps: ['create_script', 'run_script', 'remove_script', 'plot_script', 'interactive_script']
      # dset_07
      - dirname: dset_07
        params:
          - path: 'scf.ecut'
            value: 80.0
          - path: 'scf.kgrid'
            value: [2, 2, 2]
          - path: 'wfn.kgrid'
            value: [2, 2, 2]
          - path: 'wfn.parabands_cond_bands'
            value: 2501
          - path: 'wfnq.kgrid'
            value: [2, 2, 2]
          - path: 'gw.epsilon.ecut'
            value: 40.0
          - path: 'gw.epsilon.cond_bands'
            value: 2500
          - path: 'gw.sigma.ecut'
            value: 40.0
          - path: 'gw.sigma.conv_cond_bands'
            value: 2500
        link_inodes:
          - source: ../../bgwgw/dset_00/tmp
            dest: ./tmp
          - source: ../../bgwgw/dset_00/pseudos
            dest: ./pseudos
          - source: ../../bgwgw/dset_00/dftelbands.xml
            dest: ./dftelbands.xml
          - source: ../../bgwgw/dset_00/WFN_dftelbands
            dest: ./WFN_dftelbands
          - source: ../../bgwgw/dset_00/WFN_coo
            dest: ./WFN_coo
          - source: ../../bgwgw/dset_00/WFN_parabands.h5
            dest: ./WFN_parabands.h5
          - source: ../../bgwgw/dset_00/RHO
            dest: ./RHO
          - source: ../../bgwgw/dset_00/vxc.dat
            dest: ./vxc.dat
          - source: ../../bgwgw/dset_00/WFNq_coo.h5
            dest: ./WFNq_coo.h5
        generator:
          pre_steps: []
          steps: ['epsilon_bgw', 'sigma_bgw', 'gwelbands_bgw']
          post_steps: ['create_script', 'run_script', 'remove_script', 'plot_script', 'interactive_script']
      # dset_08: Start of bands convergence. 
      - dirname: dset_08
        params:
          - path: 'scf.ecut'
            value: 80.0
          - path: 'scf.kgrid'
            value: [2, 2, 2]
          - path: 'wfn.kgrid'
            value: [2, 2, 2]
          - path: 'wfn.parabands_cond_bands'
            value: 501
          - path: 'wfnq.kgrid'
            value: [2, 2, 2]
          - path: 'gw.epsilon.ecut'
            value: 30.0
          - path: 'gw.epsilon.cond_bands'
            value: 500
          - path: 'gw.sigma.ecut'
            value: 30.0
          - path: 'gw.sigma.conv_cond_bands'
            value: 500
        link_inodes:
          - source: ../../bgwgw/dset_05/tmp
            dest: ./tmp
          - source: ../../bgwgw/dset_05/pseudos
            dest: ./pseudos
          - source: ../../bgwgw/dset_05/dftelbands.xml
            dest: ./dftelbands.xml
          - source: ../../bgwgw/dset_05/WFN_dftelbands
            dest: ./WFN_dftelbands
        generator:
          pre_steps: []
          steps: ['wfn_qe', 'wfnq_qe', 'epsilon_bgw', 'sigma_bgw', 'gwelbands_bgw']
          post_steps: ['create_script', 'run_script', 'remove_script', 'plot_script', 'interactive_script']
      # dset_09
      - dirname: dset_09
        params:
          - path: 'scf.ecut'
            value: 80.0
          - path: 'scf.kgrid'
            value: [2, 2, 2]
          - path: 'wfn.kgrid'
            value: [2, 2, 2]
          - path: 'wfn.parabands_cond_bands'
            value: 1001
          - path: 'wfnq.kgrid'
            value: [2, 2, 2]
          - path: 'gw.epsilon.ecut'
            value: 30.0
          - path: 'gw.epsilon.cond_bands'
            value: 1000
          - path: 'gw.sigma.ecut'
            value: 30.0
          - path: 'gw.sigma.conv_cond_bands'
            value: 1000
        link_inodes:
          - source: ../../bgwgw/dset_05/tmp
            dest: ./tmp
          - source: ../../bgwgw/dset_05/pseudos
            dest: ./pseudos
          - source: ../../bgwgw/dset_05/dftelbands.xml
            dest: ./dftelbands.xml
          - source: ../../bgwgw/dset_05/WFN_dftelbands
            dest: ./WFN_dftelbands
        generator:
          pre_steps: []
          steps: ['wfn_qe', 'wfnq_qe', 'epsilon_bgw', 'sigma_bgw', 'gwelbands_bgw']
          post_steps: ['create_script', 'run_script', 'remove_script', 'plot_script', 'interactive_script']
      # dset_10
      - dirname: dset_10
        params:
          - path: 'scf.ecut'
            value: 80.0
          - path: 'scf.kgrid'
            value: [2, 2, 2]
          - path: 'wfn.kgrid'
            value: [2, 2, 2]
          - path: 'wfn.parabands_cond_bands'
            value: 1501
          - path: 'wfnq.kgrid'
            value: [2, 2, 2]
          - path: 'gw.epsilon.ecut'
            value: 30.0
          - path: 'gw.epsilon.cond_bands'
            value: 1500
          - path: 'gw.sigma.ecut'
            value: 30.0
          - path: 'gw.sigma.conv_cond_bands'
            value: 1500
        link_inodes:
          - source: ../../bgwgw/dset_05/tmp
            dest: ./tmp
          - source: ../../bgwgw/dset_05/pseudos
            dest: ./pseudos
          - source: ../../bgwgw/dset_05/dftelbands.xml
            dest: ./dftelbands.xml
          - source: ../../bgwgw/dset_05/WFN_dftelbands
            dest: ./WFN_dftelbands
        generator:
          pre_steps: []
          steps: ['wfn_qe', 'wfnq_qe', 'epsilon_bgw', 'sigma_bgw', 'gwelbands_bgw']
          post_steps: ['create_script', 'run_script', 'remove_script', 'plot_script', 'interactive_script']
      # dset_11
      - dirname: dset_11
        params:
          - path: 'scf.ecut'
            value: 80.0
          - path: 'scf.kgrid'
            value: [2, 2, 2]
          - path: 'wfn.kgrid'
            value: [2, 2, 2]
          - path: 'wfn.parabands_cond_bands'
            value: 2001
          - path: 'wfnq.kgrid'
            value: [2, 2, 2]
          - path: 'gw.epsilon.ecut'
            value: 30.0
          - path: 'gw.epsilon.cond_bands'
            value: 2000
          - path: 'gw.sigma.ecut'
            value: 30.0
          - path: 'gw.sigma.conv_cond_bands'
            value: 2000
        link_inodes:
          - source: ../../bgwgw/dset_05/tmp
            dest: ./tmp
          - source: ../../bgwgw/dset_05/pseudos
            dest: ./pseudos
          - source: ../../bgwgw/dset_05/dftelbands.xml
            dest: ./dftelbands.xml
          - source: ../../bgwgw/dset_05/WFN_dftelbands
            dest: ./WFN_dftelbands
        generator:
          pre_steps: []
          steps: ['wfn_qe', 'wfnq_qe', 'epsilon_bgw', 'sigma_bgw', 'gwelbands_bgw']
          post_steps: ['create_script', 'run_script', 'remove_script', 'plot_script', 'interactive_script']
      # dset_12. Start of kgrid convergence. 
      - dirname: dset_12
        params:
          - path: 'scf.ecut'
            value: 80.0
          - path: 'scf.kgrid'
            value: [2, 2, 2]
          - path: 'wfn.kgrid'
            value: [4, 4, 4]
          - path: 'wfn.parabands_cond_bands'
            value: 1001
          - path: 'wfnq.kgrid'
            value: [4, 4, 4]
          - path: 'gw.epsilon.ecut'
            value: 30.0
          - path: 'gw.epsilon.cond_bands'
            value: 1000
          - path: 'gw.sigma.ecut'
            value: 30.0
          - path: 'gw.sigma.conv_cond_bands'
            value: 1000
        link_inodes:
          - source: ../../bgwgw/dset_00/tmp
            dest: ./tmp
          - source: ../../bgwgw/dset_00/pseudos
            dest: ./pseudos
        generator:
          pre_steps: []
          steps: ['dftelbands_qe', 'wfn_qe', 'wfnq_qe', 'epsilon_bgw', 'sigma_bgw', 'gwelbands_bgw']
          post_steps: ['create_script', 'run_script', 'remove_script', 'plot_script', 'interactive_script']
      # dset_13. 
      - dirname: dset_13
        params:
          - path: 'scf.ecut'
            value: 80.0
          - path: 'scf.kgrid'
            value: [2, 2, 2]
          - path: 'wfn.kgrid'
            value: [6, 6, 6]
          - path: 'wfn.parabands_cond_bands'
            value: 1001
          - path: 'wfnq.kgrid'
            value: [6, 6, 6]
          - path: 'gw.epsilon.ecut'
            value: 30.0
          - path: 'gw.epsilon.cond_bands'
            value: 1000
          - path: 'gw.sigma.ecut'
            value: 30.0
          - path: 'gw.sigma.conv_cond_bands'
            value: 1000
        link_inodes:
          - source: ../../bgwgw/dset_00/tmp
            dest: ./tmp
          - source: ../../bgwgw/dset_00/pseudos
            dest: ./pseudos
        generator:
          pre_steps: []
          steps: ['dftelbands_qe', 'wfn_qe', 'wfnq_qe', 'epsilon_bgw', 'sigma_bgw', 'gwelbands_bgw']
          post_steps: ['create_script', 'run_script', 'remove_script', 'plot_script', 'interactive_script']
    job_info:
      <<: *big_para
    plot:
      # dirs: [dset_00, dset_01, dset_02, dset_03, dset_04, dset_05, dset_06, dset_07] # ecut convergence. 
      # dirs: [dset_08, dset_09, dset_10, dset_11, dset_05] # bands convergence. 
      dirs: [dset_09, dset_12, dset_13] # Kgrid convergence. 
  bgwbse:
    dir_list:
      # dset_00. Start of converging fine grid. 
      - dirname: dset_00
        params:
          - path: 'scf.ecut'
            value: 80.0
          - path: 'scf.kgrid'
            value: [2, 2, 2]
          - path: 'wfn.kgrid'
            value: [2, 2, 2]
          - path: 'wfn.parabands_cond_bands'
            value: 1001
          - path: 'wfnq.kgrid'
            value: [2, 2, 2]
          - path: 'wfnfi.kgrid'
            value: [2, 2, 2]
          - path: 'wfnqfi.kgrid'
            value: [2, 2, 2]
          - path: 'gw.epsilon.ecut'
            value: 10.0
          - path: 'gw.epsilon.cond_bands'
            value: 1000
          - path: 'gw.sigma.ecut'
            value: 10.0
          - path: 'gw.sigma.conv_cond_bands'
            value: 1000
        link_inodes:
          - source: ../../qescf/dset_02/tmp
            dest: ./tmp
          - source: ../../qescf/dset_02/pseudos
            dest: ./pseudos
        generator:
          pre_steps: []
          steps: ['wfn_qe', 'wfnq_qe', 'wfnfi_qe', 'wfnqfi_qe', 'epsilon_bgw', 'sigma_bgw', 'kernel_bgw', 'absorption_bgw']
          post_steps: ['create_script', 'run_script', 'remove_script', 'plot_script', 'interactive_script']
      # dset_01
      - dirname: dset_01
        params:
          - path: 'scf.ecut'
            value: 80.0
          - path: 'scf.kgrid'
            value: [2, 2, 2]
          - path: 'wfn.kgrid'
            value: [2, 2, 2]
          - path: 'wfn.parabands_cond_bands'
            value: 1001
          - path: 'wfnq.kgrid'
            value: [2, 2, 2]
          - path: 'wfnfi.kgrid'
            value: [4, 4, 4]
          - path: 'wfnqfi.kgrid'
            value: [4, 4, 4]
          - path: 'gw.epsilon.ecut'
            value: 10.0
          - path: 'gw.epsilon.cond_bands'
            value: 1000
          - path: 'gw.sigma.ecut'
            value: 10.0
          - path: 'gw.sigma.conv_cond_bands'
            value: 1000
        link_inodes:
          - source: ../../bgwbse/dset_00/tmp
            dest: ./tmp
          - source: ../../bgwbse/dset_00/pseudos
            dest: ./pseudos
          - source: ../../bgwbse/dset_00/WFN_parabands.h5
            dest: ./WFN_parabands.h5
          - source: ../../bgwbse/dset_00/WFNq_coo.h5
            dest: ./WFNq_coo.h5
          - source: ../../bgwbse/dset_00/epsmat.h5
            dest: ./epsmat.h5
          - source: ../../bgwbse/dset_00/eps0mat.h5
            dest: ./eps0mat.h5
          - source: ../../bgwbse/dset_00/eqp1.dat
            dest: ./eqp1.dat
          - source: ../../bgwbse/dset_00/bsemat.h5
            dest: ./bsemat.h5
        generator:
          pre_steps: []
          steps: ['wfnfi_qe', 'wfnqfi_qe', 'absorption_bgw']
          post_steps: ['create_script', 'run_script', 'remove_script', 'plot_script', 'interactive_script']
      # dset_02
      - dirname: dset_02
        params:
          - path: 'scf.ecut'
            value: 80.0
          - path: 'scf.kgrid'
            value: [2, 2, 2]
          - path: 'wfn.kgrid'
            value: [2, 2, 2]
          - path: 'wfn.parabands_cond_bands'
            value: 1001
          - path: 'wfnq.kgrid'
            value: [2, 2, 2]
          - path: 'wfnfi.kgrid'
            value: [6, 6, 6]
          - path: 'wfnqfi.kgrid'
            value: [6, 6, 6]
          - path: 'gw.epsilon.ecut'
            value: 10.0
          - path: 'gw.epsilon.cond_bands'
            value: 1000
          - path: 'gw.sigma.ecut'
            value: 10.0
          - path: 'gw.sigma.conv_cond_bands'
            value: 1000
        link_inodes:
          - source: ../../bgwbse/dset_00/tmp
            dest: ./tmp
          - source: ../../bgwbse/dset_00/pseudos
            dest: ./pseudos
          - source: ../../bgwbse/dset_00/WFN_parabands.h5
            dest: ./WFN_parabands.h5
          - source: ../../bgwbse/dset_00/WFNq_coo.h5
            dest: ./WFNq_coo.h5
          - source: ../../bgwbse/dset_00/epsmat.h5
            dest: ./epsmat.h5
          - source: ../../bgwbse/dset_00/eps0mat.h5
            dest: ./eps0mat.h5
          - source: ../../bgwbse/dset_00/eqp1.dat
            dest: ./eqp1.dat
          - source: ../../bgwbse/dset_00/bsemat.h5
            dest: ./bsemat.h5
        generator:
          pre_steps: []
          steps: ['wfnfi_qe', 'wfnqfi_qe', 'absorption_bgw']
          post_steps: ['create_script', 'run_script', 'remove_script', 'plot_script', 'interactive_script']
      # dset_03
      - dirname: dset_03
        params:
          - path: 'scf.ecut'
            value: 80.0
          - path: 'scf.kgrid'
            value: [2, 2, 2]
          - path: 'wfn.kgrid'
            value: [2, 2, 2]
          - path: 'wfn.parabands_cond_bands'
            value: 1001
          - path: 'wfnq.kgrid'
            value: [2, 2, 2]
          - path: 'wfnfi.kgrid'
            value: [8, 8, 8]
          - path: 'wfnqfi.kgrid'
            value: [8, 8, 8]
          - path: 'gw.epsilon.ecut'
            value: 10.0
          - path: 'gw.epsilon.cond_bands'
            value: 1000
          - path: 'gw.sigma.ecut'
            value: 10.0
          - path: 'gw.sigma.conv_cond_bands'
            value: 1000
        link_inodes:
          - source: ../../bgwbse/dset_00/tmp
            dest: ./tmp
          - source: ../../bgwbse/dset_00/pseudos
            dest: ./pseudos
          - source: ../../bgwbse/dset_00/WFN_parabands.h5
            dest: ./WFN_parabands.h5
          - source: ../../bgwbse/dset_00/WFNq_coo.h5
            dest: ./WFNq_coo.h5
          - source: ../../bgwbse/dset_00/epsmat.h5
            dest: ./epsmat.h5
          - source: ../../bgwbse/dset_00/eps0mat.h5
            dest: ./eps0mat.h5
          - source: ../../bgwbse/dset_00/eqp1.dat
            dest: ./eqp1.dat
          - source: ../../bgwbse/dset_00/bsemat.h5
            dest: ./bsemat.h5
        generator:
          pre_steps: []
          steps: ['wfnfi_qe', 'wfnqfi_qe', 'absorption_bgw']
          post_steps: ['create_script', 'run_script', 'remove_script', 'plot_script', 'interactive_script']
      # dset_04
      - dirname: dset_04
        params:
          - path: 'scf.ecut'
            value: 80.0
          - path: 'scf.kgrid'
            value: [2, 2, 2]
          - path: 'wfn.kgrid'
            value: [2, 2, 2]
          - path: 'wfn.parabands_cond_bands'
            value: 1001
          - path: 'wfnq.kgrid'
            value: [2, 2, 2]
          - path: 'wfnfi.kgrid'
            value: [12, 12, 12]
          - path: 'wfnqfi.kgrid'
            value: [12, 12, 12]
          - path: 'gw.epsilon.ecut'
            value: 10.0
          - path: 'gw.epsilon.cond_bands'
            value: 1000
          - path: 'gw.sigma.ecut'
            value: 10.0
          - path: 'gw.sigma.conv_cond_bands'
            value: 1000
        link_inodes:
          - source: ../../bgwbse/dset_00/tmp
            dest: ./tmp
          - source: ../../bgwbse/dset_00/pseudos
            dest: ./pseudos
          - source: ../../bgwbse/dset_00/WFN_parabands.h5
            dest: ./WFN_parabands.h5
          - source: ../../bgwbse/dset_00/WFNq_coo.h5
            dest: ./WFNq_coo.h5
          - source: ../../bgwbse/dset_00/epsmat.h5
            dest: ./epsmat.h5
          - source: ../../bgwbse/dset_00/eps0mat.h5
            dest: ./eps0mat.h5
          - source: ../../bgwbse/dset_00/eqp1.dat
            dest: ./eqp1.dat
          - source: ../../bgwbse/dset_00/bsemat.h5
            dest: ./bsemat.h5
        generator:
          pre_steps: []
          steps: ['wfnfi_qe', 'wfnqfi_qe', 'absorption_bgw']
          post_steps: ['create_script', 'run_script', 'remove_script', 'plot_script', 'interactive_script']
      # dset_05. Start of converging coarse grid. 
      - dirname: dset_05
        params:
          - path: 'scf.ecut'
            value: 80.0
          - path: 'scf.kgrid'
            value: [2, 2, 2]
          - path: 'wfn.kgrid'
            value: [4, 4, 4]
          - path: 'wfn.parabands_cond_bands'
            value: 1001
          - path: 'wfnq.kgrid'
            value: [4, 4, 4]
          - path: 'wfnfi.kgrid'
            value: [8, 8, 8]
          - path: 'wfnqfi.kgrid'
            value: [8, 8, 8]
          - path: 'gw.epsilon.ecut'
            value: 10.0
          - path: 'gw.epsilon.cond_bands'
            value: 1000
          - path: 'gw.sigma.ecut'
            value: 10.0
          - path: 'gw.sigma.conv_cond_bands'
            value: 1000
          - path: 'bse.absorption.wfnco_link'
            value: 'WFN_parabands.h5'
          - path: 'bse.absorption.wfnqco_link'
            value: 'WFNq_coo.h5'
          - path: 'bse.absorption.wfnfi_link'
            value: 'WFN_fii.h5'
          - path: 'bse.absorption.wfnqfi_link'
            value: 'WFNq_fii.h5'
        link_inodes:
          - source: ../../bgwbse/dset_03/tmp
            dest: ./tmp
          - source: ../../bgwbse/dset_03/pseudos
            dest: ./pseudos
          - source: ../../bgwgw/dset_12/WFN_parabands.h5
            dest: ./WFN_parabands.h5
          - source: ../../bgwgw/dset_12/WFNq_fii.h5
            dest: ./WFNq_coo.h5
          - source: ../../bgwgw/dset_12/epsmat.h5
            dest: ./epsmat.h5
          - source: ../../bgwgw/dset_12/eps0mat.h5
            dest: ./eps0mat.h5
          - source: ../../bgwgw/dset_12/eqp1.dat
            dest: ./eqp1.dat
          - source: ../../bgwbse/dset_03/WFN_fii.h5
            dest: ./WFN_fii.h5
          - source: ../../bgwbse/dset_03/WFNq_fii.h5
            dest: ./WFNq_fii.h5
        generator:
          pre_steps: []
          steps: ['kernel_bgw', 'absorption_bgw']
          post_steps: ['create_script', 'run_script', 'remove_script', 'plot_script', 'interactive_script'] 
      # dset_06
      - dirname: dset_06
        params:
          - path: 'scf.ecut'
            value: 80.0
          - path: 'scf.kgrid'
            value: [2, 2, 2]
          - path: 'wfn.kgrid'
            value: [6, 6, 6]
          - path: 'wfn.parabands_cond_bands'
            value: 1001
          - path: 'wfnq.kgrid'
            value: [6, 6, 6]
          - path: 'wfnfi.kgrid'
            value: [8, 8, 8]
          - path: 'wfnqfi.kgrid'
            value: [8, 8, 8]
          - path: 'gw.epsilon.ecut'
            value: 10.0
          - path: 'gw.epsilon.cond_bands'
            value: 1000
          - path: 'gw.sigma.ecut'
            value: 10.0
          - path: 'gw.sigma.conv_cond_bands'
            value: 1000
          - path: 'bse.absorption.wfnco_link'
            value: 'WFN_parabands.h5'
          - path: 'bse.absorption.wfnqco_link'
            value: 'WFNq_coo.h5'
          - path: 'bse.absorption.wfnfi_link'
            value: 'WFN_fii.h5'
          - path: 'bse.absorption.wfnqfi_link'
            value: 'WFNq_fii.h5'
        link_inodes:
          - source: ../../bgwbse/dset_03/tmp
            dest: ./tmp
          - source: ../../bgwbse/dset_03/pseudos
            dest: ./pseudos
          - source: ../../bgwgw/dset_13/WFN_parabands.h5
            dest: ./WFN_parabands.h5
          - source: ../../bgwgw/dset_13/WFNq_fii.h5
            dest: ./WFNq_coo.h5
          - source: ../../bgwgw/dset_13/epsmat.h5
            dest: ./epsmat.h5
          - source: ../../bgwgw/dset_13/eps0mat.h5
            dest: ./eps0mat.h5
          - source: ../../bgwgw/dset_13/eqp1.dat
            dest: ./eqp1.dat
          - source: ../../bgwbse/dset_03/WFN_fii.h5
            dest: ./WFN_fii.h5
          - source: ../../bgwbse/dset_03/WFNq_fii.h5
            dest: ./WFNq_fii.h5
        generator:
          pre_steps: []
          steps: ['kernel_bgw', 'absorption_bgw']
          post_steps: ['create_script', 'run_script', 'remove_script', 'plot_script', 'interactive_script']     
    job_info:
      <<: *big_para
    plot:
      # dirs: [dset_03, dset_05, dset_06]   # For comparing coarse grid only. 
      dirs: [dset_00, dset_01, dset_02, dset_03, dset_04]   # For comparing fine grid only.
      eigs: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]  


# # For custom job info.
# job_info:
#  name: 'custom_scheduler_name'
#  is_interactive: false
#  header:
#   non_interactive:
#     account: m3571
#     qos: regular
#     constraint: cpu
#     job-name: struct_job
#  nodes: 1
#  ntasks: 128
#  time: "02:45:00"